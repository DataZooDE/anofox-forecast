# Basic Forecasting Guide

## Introduction

This guide covers the forecasting workflow using the Anofox Forecast extension's SQL API. Topics include data preparation, model selection, forecast generation, and accuracy evaluation.

**API Functions Covered**: `TS_FORECAST()`, `TS_FORECAST_BY()`, evaluation metrics, and data preparation macros.

## What is Time Series Forecasting?

Time series forecasting predicts future values based on historical patterns. Common patterns include:
- **Trend**: Long-term increase or decrease
- **Seasonality**: Regular repeating patterns (weekly, monthly, yearly)
- **Cycles**: Non-regular fluctuations
- **Noise**: Random variation

## The Forecasting Workflow

```
Raw Data → Data Preparation → Forecasting → Evaluation → Deployment
```

### 1. Data Preparation

#### Check Data Quality

<!-- include: test/sql/docs_examples/30_basic_forecasting_data_quality_01.sql -->

#### Handle Common Issues

<!-- include: test/sql/docs_examples/30_basic_forecasting_data_quality_02.sql -->

### 2. Detect Seasonality

<!-- include: test/sql/docs_examples/30_basic_forecasting_create_sample_data_03.sql -->

### 3. Generate Forecasts

#### Single Series

<!-- include: test/sql/docs_examples/30_basic_forecasting_forecast_04.sql -->

#### Multiple Series

<!-- include: test/sql/docs_examples/30_basic_forecasting_multi_series_05.sql -->

### 4. Evaluate Forecasts

#### Accuracy Metrics

<!-- include: test/sql/docs_examples/30_basic_forecasting_evaluate_06.sql -->

#### Interval Coverage

<!-- include: test/sql/docs_examples/30_basic_forecasting_example_07.sql -->

## Understanding the Output

### Forecast Output Schema

| Column | Type | Description |
|--------|------|-------------|
| `forecast_step` | INTEGER | Horizon step (1, 2, 3, ..., horizon) |
| `date_col` | DATE\|TIMESTAMP\|INTEGER | Forecast timestamp (type matches input) |
| `point_forecast` | DOUBLE | Point forecast value |
| `lower` | DOUBLE | Lower prediction interval bound |
| `upper` | DOUBLE | Upper prediction interval bound |
| `model_name` | VARCHAR | Model name used for forecast |
| `insample_fitted` | DOUBLE[] | Fitted values (optional, via `return_insample: true`) |
| `confidence_level` | DOUBLE | Confidence level used for intervals |

**Behavioral Notes**:
- Date column type preserved from input (INTEGER, DATE, or TIMESTAMP)
- Prediction intervals computed at specified confidence level (default 0.90)
- `insample_fitted` array has length equal to training data size (empty by default)

### Interpreting Results

**Point Forecast**: Best estimate (mean/median of distribution)

**Confidence Intervals**:
- 90% CI: 90% chance actual value falls within [lower, upper]
- Wider intervals = more uncertainty
- Intervals grow with forecast horizon

**Example**:
```
forecast_step=1: [95, 105] (width=10)
forecast_step=7: [85, 115] (width=30) ← More uncertain
```

-- Test data for comparing Rust port vs C++ community extension
-- All values are deterministic for reproducible testing

-- Random-like series (100 points, deterministic pseudo-random using modulo arithmetic)
CREATE OR REPLACE TABLE test_random_series AS
SELECT
    [10.5, 12.3, 9.8, 14.2, 11.7, 13.1, 10.9, 15.3, 12.8, 11.4,
     13.7, 9.2, 14.8, 10.1, 12.5, 11.9, 13.4, 10.7, 14.1, 12.2,
     10.3, 13.9, 11.1, 14.5, 9.6, 12.9, 13.2, 10.4, 11.6, 14.7,
     12.1, 9.9, 13.5, 10.8, 14.3, 11.5, 12.7, 13.8, 10.2, 11.8,
     14.4, 9.7, 12.6, 13.3, 10.6, 14.9, 11.3, 12.4, 13.6, 10.0,
     14.6, 11.2, 9.5, 13.0, 12.0, 10.5, 14.0, 11.0, 13.1, 12.3,
     9.8, 14.2, 11.7, 10.9, 15.3, 12.8, 11.4, 13.7, 9.2, 14.8,
     10.1, 12.5, 11.9, 13.4, 10.7, 14.1, 12.2, 10.3, 13.9, 11.1,
     14.5, 9.6, 12.9, 13.2, 10.4, 11.6, 14.7, 12.1, 9.9, 13.5,
     10.8, 14.3, 11.5, 12.7, 13.8, 10.2, 11.8, 14.4, 9.7, 12.6]::DOUBLE[] AS values;

-- Trending series (linear trend)
CREATE OR REPLACE TABLE test_trending_series AS
SELECT
    [1.0, 2.1, 3.2, 4.3, 5.4, 6.5, 7.6, 8.7, 9.8, 10.9,
     12.0, 13.1, 14.2, 15.3, 16.4, 17.5, 18.6, 19.7, 20.8, 21.9,
     23.0, 24.1, 25.2, 26.3, 27.4, 28.5, 29.6, 30.7, 31.8, 32.9,
     34.0, 35.1, 36.2, 37.3, 38.4, 39.5, 40.6, 41.7, 42.8, 43.9,
     45.0, 46.1, 47.2, 48.3, 49.4, 50.5, 51.6, 52.7, 53.8, 54.9]::DOUBLE[] AS values;

-- Seasonal series (sin wave with period 7, amplitude 10, offset 50)
CREATE OR REPLACE TABLE test_seasonal_series AS
SELECT
    [50.0, 57.8, 59.7, 54.3, 44.0, 37.2, 35.5, 40.5, 50.0, 57.8,
     59.7, 54.3, 44.0, 37.2, 35.5, 40.5, 50.0, 57.8, 59.7, 54.3,
     44.0, 37.2, 35.5, 40.5, 50.0, 57.8, 59.7, 54.3, 44.0, 37.2,
     35.5, 40.5, 50.0, 57.8, 59.7, 54.3, 44.0, 37.2, 35.5, 40.5,
     50.0, 57.8, 59.7, 54.3, 44.0, 37.2, 35.5, 40.5, 50.0, 57.8,
     59.7, 54.3, 44.0, 37.2, 35.5, 40.5, 50.0, 57.8, 59.7, 54.3,
     44.0, 37.2, 35.5, 40.5, 50.0, 57.8, 59.7, 54.3, 44.0, 37.2,
     35.5, 40.5, 50.0, 57.8, 59.7, 54.3, 44.0, 37.2, 35.5, 40.5,
     50.0, 57.8, 59.7, 54.3, 44.0, 37.2, 35.5, 40.5, 50.0, 57.8,
     59.7, 54.3, 44.0, 37.2, 35.5, 40.5, 50.0, 57.8, 59.7, 54.3]::DOUBLE[] AS values;

-- Series with NULLs
CREATE OR REPLACE TABLE test_nulls_series AS
SELECT
    [1.0, 2.0, NULL, 4.0, 5.0, NULL, NULL, 8.0, 9.0, 10.0,
     NULL, 12.0, 13.0, NULL, 15.0, 16.0, 17.0, NULL, 19.0, 20.0]::DOUBLE[] AS values;

-- Series with changepoints (two distinct levels)
CREATE OR REPLACE TABLE test_changepoint_series AS
SELECT
    [10.1, 10.3, 9.8, 10.2, 10.0, 9.9, 10.4, 10.1, 9.7, 10.2,
     10.0, 10.3, 9.8, 10.1, 10.2, 9.9, 10.0, 10.1, 9.8, 10.3,
     10.2, 9.9, 10.1, 10.0, 9.8,
     50.1, 50.3, 49.8, 50.2, 50.0, 49.9, 50.4, 50.1, 49.7, 50.2,
     50.0, 50.3, 49.8, 50.1, 50.2, 49.9, 50.0, 50.1, 49.8, 50.3,
     50.2, 49.9, 50.1, 50.0, 49.8]::DOUBLE[] AS values;

-- Actual/Forecast pairs for metric functions
CREATE OR REPLACE TABLE test_metric_pairs AS
SELECT
    [10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0,
     15.0, 25.0, 35.0, 45.0, 55.0, 65.0, 75.0, 85.0, 95.0, 105.0]::DOUBLE[] AS actual,
    [11.0, 19.5, 31.0, 38.5, 52.0, 59.0, 71.5, 78.5, 92.0, 98.5,
     14.5, 26.0, 34.0, 46.5, 53.5, 66.0, 74.0, 86.5, 93.5, 106.0]::DOUBLE[] AS forecast,
    [9.0, 17.0, 28.0, 35.0, 48.0, 55.0, 67.0, 74.0, 88.0, 94.0,
     12.0, 22.0, 31.0, 42.0, 49.0, 62.0, 70.0, 82.0, 89.0, 101.0]::DOUBLE[] AS lower_bound,
    [13.0, 22.0, 34.0, 42.0, 56.0, 63.0, 76.0, 83.0, 96.0, 103.0,
     17.0, 30.0, 37.0, 51.0, 58.0, 70.0, 78.0, 91.0, 98.0, 111.0]::DOUBLE[] AS upper_bound;

-- Short series (for testing ts_drop_short)
CREATE OR REPLACE TABLE test_short_series AS
SELECT
    [1.0, 2.0, 3.0, 4.0, 5.0]::DOUBLE[] AS values;

-- Constant series
CREATE OR REPLACE TABLE test_constant_series AS
SELECT
    [42.0, 42.0, 42.0, 42.0, 42.0, 42.0, 42.0, 42.0, 42.0, 42.0,
     42.0, 42.0, 42.0, 42.0, 42.0, 42.0, 42.0, 42.0, 42.0, 42.0]::DOUBLE[] AS values;

-- Series with leading zeros
CREATE OR REPLACE TABLE test_leading_zeros_series AS
SELECT
    [0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 10.0, 15.0, 20.0, 25.0,
     30.0, 35.0, 40.0, 45.0, 50.0]::DOUBLE[] AS values;

-- Series with trailing zeros
CREATE OR REPLACE TABLE test_trailing_zeros_series AS
SELECT
    [5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0,
     0.0, 0.0, 0.0, 0.0, 0.0]::DOUBLE[] AS values;

-- Series with edge zeros (both leading and trailing)
CREATE OR REPLACE TABLE test_edge_zeros_series AS
SELECT
    [0.0, 0.0, 0.0, 5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 0.0, 0.0, 0.0]::DOUBLE[] AS values;

-- Grouped data for _by functions (3 groups with different patterns)
CREATE OR REPLACE TABLE test_grouped_data AS
SELECT * FROM (
    VALUES
    ('A', DATE '2024-01-01', 10.0),
    ('A', DATE '2024-01-02', 12.0),
    ('A', DATE '2024-01-03', 11.0),
    ('A', DATE '2024-01-04', 13.0),
    ('A', DATE '2024-01-05', 12.5),
    ('A', DATE '2024-01-06', 14.0),
    ('A', DATE '2024-01-07', 13.5),
    ('A', DATE '2024-01-08', 15.0),
    ('A', DATE '2024-01-09', 14.5),
    ('A', DATE '2024-01-10', 16.0),
    ('A', DATE '2024-01-11', 15.5),
    ('A', DATE '2024-01-12', 17.0),
    ('A', DATE '2024-01-13', 16.5),
    ('A', DATE '2024-01-14', 18.0),
    ('A', DATE '2024-01-15', 17.5),
    ('A', DATE '2024-01-16', 19.0),
    ('A', DATE '2024-01-17', 18.5),
    ('A', DATE '2024-01-18', 20.0),
    ('A', DATE '2024-01-19', 19.5),
    ('A', DATE '2024-01-20', 21.0),
    ('B', DATE '2024-01-01', 50.0),
    ('B', DATE '2024-01-02', 52.0),
    ('B', DATE '2024-01-03', 48.0),
    ('B', DATE '2024-01-04', 53.0),
    ('B', DATE '2024-01-05', 47.0),
    ('B', DATE '2024-01-06', 54.0),
    ('B', DATE '2024-01-07', 46.0),
    ('B', DATE '2024-01-08', 55.0),
    ('B', DATE '2024-01-09', 45.0),
    ('B', DATE '2024-01-10', 56.0),
    ('B', DATE '2024-01-11', 44.0),
    ('B', DATE '2024-01-12', 57.0),
    ('B', DATE '2024-01-13', 43.0),
    ('B', DATE '2024-01-14', 58.0),
    ('B', DATE '2024-01-15', 42.0),
    ('B', DATE '2024-01-16', 59.0),
    ('B', DATE '2024-01-17', 41.0),
    ('B', DATE '2024-01-18', 60.0),
    ('B', DATE '2024-01-19', 40.0),
    ('B', DATE '2024-01-20', 61.0),
    ('C', DATE '2024-01-01', 100.0),
    ('C', DATE '2024-01-02', 100.0),
    ('C', DATE '2024-01-03', 100.0),
    ('C', DATE '2024-01-04', 100.0),
    ('C', DATE '2024-01-05', 100.0),
    ('C', DATE '2024-01-06', 100.0),
    ('C', DATE '2024-01-07', 100.0),
    ('C', DATE '2024-01-08', 100.0),
    ('C', DATE '2024-01-09', 100.0),
    ('C', DATE '2024-01-10', 100.0),
    ('C', DATE '2024-01-11', 100.0),
    ('C', DATE '2024-01-12', 100.0),
    ('C', DATE '2024-01-13', 100.0),
    ('C', DATE '2024-01-14', 100.0),
    ('C', DATE '2024-01-15', 100.0),
    ('C', DATE '2024-01-16', 100.0),
    ('C', DATE '2024-01-17', 100.0),
    ('C', DATE '2024-01-18', 100.0),
    ('C', DATE '2024-01-19', 100.0),
    ('C', DATE '2024-01-20', 100.0)
) AS t(group_id, date_col, value_col);

-- Longer seasonal + trend series for decomposition testing (140 points = 20 weeks)
CREATE OR REPLACE TABLE test_decomposition_series AS
SELECT
    [
    -- Week 1-5 (baseline ~100)
    100.0, 105.0, 103.0, 98.0, 102.0, 110.0, 95.0,
    101.0, 106.0, 104.0, 99.0, 103.0, 111.0, 96.0,
    102.0, 107.0, 105.0, 100.0, 104.0, 112.0, 97.0,
    103.0, 108.0, 106.0, 101.0, 105.0, 113.0, 98.0,
    104.0, 109.0, 107.0, 102.0, 106.0, 114.0, 99.0,
    -- Week 6-10 (trend up ~110)
    115.0, 120.0, 118.0, 113.0, 117.0, 125.0, 110.0,
    116.0, 121.0, 119.0, 114.0, 118.0, 126.0, 111.0,
    117.0, 122.0, 120.0, 115.0, 119.0, 127.0, 112.0,
    118.0, 123.0, 121.0, 116.0, 120.0, 128.0, 113.0,
    119.0, 124.0, 122.0, 117.0, 121.0, 129.0, 114.0,
    -- Week 11-15 (trend up ~120)
    130.0, 135.0, 133.0, 128.0, 132.0, 140.0, 125.0,
    131.0, 136.0, 134.0, 129.0, 133.0, 141.0, 126.0,
    132.0, 137.0, 135.0, 130.0, 134.0, 142.0, 127.0,
    133.0, 138.0, 136.0, 131.0, 135.0, 143.0, 128.0,
    134.0, 139.0, 137.0, 132.0, 136.0, 144.0, 129.0,
    -- Week 16-20 (trend up ~130)
    145.0, 150.0, 148.0, 143.0, 147.0, 155.0, 140.0,
    146.0, 151.0, 149.0, 144.0, 148.0, 156.0, 141.0,
    147.0, 152.0, 150.0, 145.0, 149.0, 157.0, 142.0,
    148.0, 153.0, 151.0, 146.0, 150.0, 158.0, 143.0,
    149.0, 154.0, 152.0, 147.0, 151.0, 159.0, 144.0
    ]::DOUBLE[] AS values;

# name: test/sql/test_real_data.test
# description: test that FORECAST reads actual table data with table-in-out pattern
# group: [sql]

require anofox_forecast

# Create table with specific values
statement ok
CREATE TABLE simple_data (ts TIMESTAMP, val DOUBLE);

statement ok  
INSERT INTO simple_data VALUES
    ('2024-01-01', 10.0),
    ('2024-01-02', 20.0),
    ('2024-01-03', 30.0);

# Test 1: Try passing table as subquery
query I
SELECT point_forecast 
FROM FORECAST(
    (SELECT ts, val FROM simple_data ORDER BY ts),
    'Naive', 
    1, 
    NULL
);
----
30.0

statement ok
DROP TABLE simple_data;
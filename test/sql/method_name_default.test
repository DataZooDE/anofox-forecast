# name: test/sql/method_name_default.test
# description: Test default method_name behavior (backward compatibility)
# group: [sql]

require anofox_forecast

statement ok
LOAD anofox_forecast;

# Create test data
statement ok
CREATE TABLE test_data AS
SELECT 
    ('2024-01-01'::TIMESTAMP + INTERVAL (i) DAY) AS date_col,
    (100.0 + i * 1.5)::DOUBLE AS value
FROM generate_series(1, 30) t(i);

# Test 1: Naive model returns default name
query I
SELECT model_name = 'Naive'
FROM ts_forecast(test_data, date_col, value, 'Naive', 5, NULL)
LIMIT 1;
----
true

# Test 2: SES model returns default name
query I
SELECT model_name = 'SimpleExponentialSmoothing'
FROM ts_forecast(test_data, date_col, value, 'SES', 5, {'alpha': 0.3})
LIMIT 1;
----
true

# Test 3: Holt model returns 'AutoETS' (it wraps AutoETS internally)
query I
SELECT model_name = 'AutoETS'
FROM ts_forecast(test_data, date_col, value, 'Holt', 5, {'alpha': 0.8, 'beta': 0.2})
LIMIT 1;
----
true

# Test 4: AutoETS model returns default name
query I
SELECT model_name = 'AutoETS'
FROM ts_forecast(test_data, date_col, value, 'AutoETS', 5, {'season_length': 7})
LIMIT 1;
----
true

# Test 5: Theta model returns default name
query I
SELECT model_name = 'Theta'
FROM ts_forecast(test_data, date_col, value, 'Theta', 5, {'seasonal_period': 7})
LIMIT 1;
----
true

# Test 6: SMA model returns default name
query I
SELECT model_name = 'SimpleMovingAverage'
FROM ts_forecast(test_data, date_col, value, 'SMA', 5, {'window': 5})
LIMIT 1;
----
true

# Test 7: SeasonalNaive model returns default name
query I
SELECT model_name = 'SeasonalNaive'
FROM ts_forecast(test_data, date_col, value, 'SeasonalNaive', 5, {'seasonal_period': 7})
LIMIT 1;
----
true

# Test 8: Empty MAP returns default names
query I
SELECT model_name = 'Naive'
FROM ts_forecast(test_data, date_col, value, 'Naive', 5, MAP{})
LIMIT 1;
----
true

# Cleanup
statement ok
DROP TABLE test_data;


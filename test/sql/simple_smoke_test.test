# name: test/sql/simple_smoke_test.test
# description: Simple smoke test for anofox_forecast extension
# group: [sql]

require anofox_forecast

statement ok
LOAD anofox_forecast;

# Create simple test data
statement ok
CREATE TABLE test_data AS
SELECT i::INTEGER AS step, (100.0 + i)::DOUBLE AS value
FROM generate_series(1, 20) t(i);

# Test: TS_FORECAST_AGG aggregate function
statement ok
CREATE TABLE forecast_result AS
SELECT TS_FORECAST_AGG(step, value, 'Naive', 5, NULL) AS result
FROM test_data;

# Verify forecast was generated
query I
SELECT len(result.point_forecast) = 5
FROM forecast_result;
----
true

# Test: ts_forecast table macro
statement ok
CREATE TABLE macro_result AS
SELECT * FROM ts_forecast(test_data, 'step', 'value', 'Naive', 5, NULL);

# Verify macro returned 5 forecast steps
query I
SELECT COUNT(*) = 5
FROM macro_result;
----
true

# Cleanup
statement ok
DROP TABLE test_data;

statement ok
DROP TABLE forecast_result;

statement ok
DROP TABLE macro_result;

